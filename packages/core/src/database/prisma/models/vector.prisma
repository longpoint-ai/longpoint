model VectorIndex {
  id               String   @id @default(cuid(2))
  name             String   @unique
  /// Fully qualified model ID of the embedding model to use for this index
  embeddingModelId String
  /// Vector storage provider ID
  vectorStorageId  String
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt

  documents VectorDocument[]

  @@index([embeddingModelId])
  @@index([vectorStorageId])
}

model VectorDocument {
  id           String               @id @default(cuid(2))
  /// Direct storage of the embedding vector
  // embedding    Unsupported("vector")?
  /// External ID of the document if using external vector storage
  externalId   String               @unique
  /// Original document metadata
  metadata     Json?
  status       VectorDocumentStatus @default(PENDING)
  errorMessage String?
  createdAt    DateTime             @default(now())
  updatedAt    DateTime             @updatedAt

  indexId          String
  index            VectorIndex    @relation(fields: [indexId], references: [id], onDelete: Cascade)
  mediaContainerId String         @unique
  mediaContainer   MediaContainer @relation(fields: [mediaContainerId], references: [id], onDelete: Cascade)

  @@index([indexId])
  @@index([status])
  @@index([mediaContainerId])
}

enum VectorDocumentStatus {
  PENDING
  INDEXING
  INDEXED
  FAILED
}
